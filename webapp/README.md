# EyeWitness Web Application

Dynamic security analysis visualization platform for EyeWitness scan results.

## ğŸš€ TL;DR

```bash
cd webapp && ./start.sh
# Open http://localhost:5000
```

**Key Info:**
- **Port:** 5000 (backend + frontend)
- **Max Results:** 5000 per page
- **No HTML Reports:** Use webapp only (static reports disabled by default)

## Quick Start

### Recommended: Production Mode (Integrated)
```bash
cd webapp
./start.sh
```

This will:
- Start the backend API on **port 5000**
- Serve the pre-built frontend from the same port
- Automatically use the most recent database
- Access at: **http://localhost:5000**

### With Specific Project
```bash
cd webapp
./start.sh laboon
```

This will use the `laboon` project database from `eyewitness_projects/laboon/`.

### Using Environment Variable
```bash
export EYEWITNESS_PROJECT=laboon
cd webapp
./start.sh
```

## Running EyeWitness with Projects

Create a new project scan:
```bash
python3 Python/EyeWitness.py --web -f urls.txt --enable-ai --test-credentials --db laboon
```

This creates:
- Database: `eyewitness_projects/laboon/laboon.db`
- Screenshots: `eyewitness_projects/laboon/screens/`
- Source code: `eyewitness_projects/laboon/source/`
- CSV exports: `eyewitness_projects/laboon/*.csv`

**Note:** Static HTML reports are **disabled by default**. All data is accessed through the webapp.

## API Endpoints

### Project Management

**List Available Projects**
```bash
curl http://localhost:5000/api/projects
```

Returns:
```json
{
  "projects": [
    {
      "name": "laboon",
      "db_path": "/path/to/eyewitness_projects/laboon/laboon.db",
      "last_modified": "2025-12-28T23:00:00",
      "size_mb": 18.52,
      "is_current": true,
      "is_default": true
    }
  ],
  "current_project": "laboon",
  "total": 1,
  "env_project": "laboon"
}
```

**Load a Specific Project**
```bash
curl -X POST "http://localhost:5000/api/load-project?project_name=laboon"
```

**Load a Database by Path**
```bash
curl -X POST "http://localhost:5000/api/load-database?db_path=/path/to/ew.db"
```

**Get Reports (supports up to 5000 results per page)**
```bash
curl "http://localhost:5000/api/reports?page_size=1000"
```

## Accessing the Application

### Production Mode (Recommended)
- **Integrated App**: http://localhost:5000
- **API Docs**: http://localhost:5000/docs
- **Screenshots**: Served directly from the backend

### Development Mode
- **Frontend Dev Server**: http://localhost:3000 (with hot reload)
- **Backend API**: http://localhost:5000
- **API Docs**: http://localhost:5000/docs

## Features

- ğŸ“Š **Dashboard**: Overview statistics, vulnerability trends, top applications
- ğŸ“‹ **Reports**: Detailed scan results with filters and search (up to 5000 results)
- ğŸ” **Passwords**: Vulnerable credentials analysis and recommendations
- ğŸ¤– **AI Analysis**: Application detection results with confidence scores
- ğŸ–¼ï¸ **Gallery**: Screenshot browser with risk indicators
- ğŸ—‚ï¸ **Multi-Project**: Easily switch between different scan projects
- âš¡ **Fast**: Direct database access, no HTML file generation needed

## Recent Updates (v2.1)

### Signatures System
- **Removed status tracking** from `signatures.json` - test results now only in project database
- **Removed `last_tested`** field - signatures file only stores known default credentials
- **New category system**: More accurate categorization (storage, network_device, printer, etc.)
- **Source types**: `default`, `documented`, `common`, `manual` (instead of working/failed/untested)

### Performance
- **Increased limits**: Backend supports up to 5000 results per page (was 200)
- **Frontend optimized**: Gallery loads 5000 results by default
- **Correct port**: Fixed frontend to connect to port 5000 

### Cleanup
- **No static HTML**: `detail_*.html` and `report_page*.html` no longer generated by default
- **No CSS/JS copying**: Static assets only served via webapp
- **Cleaner projects**: Only essential files (DB, screenshots, CSV)

## Project Structure

```
EyeWitness/
â”œâ”€â”€ Python/
â”‚   â”œâ”€â”€ EyeWitness.py           # Main scanner
â”‚   â”œâ”€â”€ signatures.json         # Known credentials (v2.1)
â”‚   â””â”€â”€ modules/
â”‚       â”œâ”€â”€ signature_manager.py    # Manages signatures
â”‚       â”œâ”€â”€ reporting.py            # Report generation (static disabled)
â”‚       â””â”€â”€ ai_credential_analyzer.py
â”‚
â”œâ”€â”€ webapp/
â”‚   â”œâ”€â”€ backend/
â”‚   â”‚   â”œâ”€â”€ main.py             # FastAPI server (port 5000)
â”‚   â”‚   â””â”€â”€ venv/               # Python venv
â”‚   â”œâ”€â”€ frontend/
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/          # Dashboard, Reports, Gallery
â”‚   â”‚   â”‚   â””â”€â”€ services/       # API client (port 5000)
â”‚   â”‚   â””â”€â”€ dist/               # Built frontend (served by backend)
â”‚   â”œâ”€â”€ start.sh                # Launcher script
â”‚   â””â”€â”€ README.md               # This file
â”‚
â””â”€â”€ eyewitness_projects/
    â””â”€â”€ laboon/                 # Example project
        â”œâ”€â”€ laboon.db           # SQLite database
        â”œâ”€â”€ screens/            # Screenshots (PNG)
        â”œâ”€â”€ source/             # HTML source code
        â”œâ”€â”€ Requests.csv        # Export of all requests
        â”œâ”€â”€ open_ports.csv      # Open ports detected
        â””â”€â”€ auth_methods_for_spraying.json
```

### File Types by Purpose

**Essential for webapp:**
- `*.db` - SQLite database (all scan data)
- `screens/*.png` - Screenshots
- `source/*.txt` - HTML source code

**Optional exports:**
- `Requests.csv` - All HTTP requests
- `open_ports.csv` - Open ports
- `auth_methods_for_spraying.json` - Auth methods found

**No longer generated:**
- `detail_*.html` - Static detail pages (disabled)
- `report_page*.html` - Static report pages (disabled)
- `gallery.html` - Static gallery (disabled)
- `bootstrap.*.css/js` - Static assets (not copied)

## Development

### Building the Frontend
```bash
cd webapp/frontend
npm install          # First time only
npm run build        # Build for production
```

The built files go to `frontend/dist/` and are served by the backend in production mode.

### Backend Development
```bash
cd webapp/backend
source venv/bin/activate
uvicorn main:app --host 0.0.0.0 --port 5000 --reload
```

### Frontend Development (with hot reload)
```bash
cd webapp/frontend
npm run dev
```

This starts a dev server on port 3000 that proxies API calls to port 5000.

**Note:** Update `src/services/api.ts` if backend is on a different port:
```typescript
const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:5000'
```

## Configuration

### Backend Port
Default: **5000**

Change in `backend/main.py` or when starting uvicorn:
```bash
uvicorn main:app --host 0.0.0.0 --port YOUR_PORT
```

### Result Limits
- Maximum results per page: **5000** (configurable in `backend/main.py`)
- Gallery default load: **5000** results (configurable in `frontend/src/pages/Gallery.tsx`)

### Static HTML Reports
Static HTML reports (`detail_*.html`, `report_page*.html`) are **disabled by default**.

To enable them, edit `Python/modules/reporting.py`:
```python
GENERATE_STATIC_REPORTS = True  # Change from False to True
```

## Troubleshooting

**Database not found:**
- Ensure you've run EyeWitness with `--db project_name` first
- Check that the database exists: `ls -la eyewitness_projects/*/`
- Set `EYEWITNESS_PROJECT` environment variable
- Or use the `/api/projects` endpoint to see available projects

**Screenshots not loading:**
- Verify screenshots exist: `ls -la eyewitness_projects/project_name/screens/`
- Check backend logs for 404 errors
- Ensure the database path is correct
- Screenshots must be in `<project>/screens/` directory

**Only seeing 200 results:**
- Check `frontend/src/services/api.ts` - should be port **5000**
- Rebuild frontend: `cd frontend && npm run build`
- Load a project: `curl -X POST "http://localhost:5000/api/load-project?project_name=laboon"`

**Port already in use:**
- Check for duplicate servers: `netstat -tlnp | grep 5000`
- Kill duplicate processes: `pkill -f "uvicorn main:app"`
- Backend default: **5000** (change in `main.py`)
- Frontend dev: **3000** (change in `vite.config.ts`)

**Multiple backends running:**
```bash
# Check running servers
ps aux | grep uvicorn | grep -v grep

# Kill all uvicorn processes
pkill -f "uvicorn main:app"

# Start fresh
cd webapp && ./start.sh
```
